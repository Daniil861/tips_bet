(()=>{"use strict";let e=!1;setTimeout((()=>{if(e){let e=new Event("windowScroll");window.addEventListener("scroll",(function(t){document.dispatchEvent(e)}))}}),0),sessionStorage.getItem("preloader")&&(document.querySelector(".preloader")&&document.querySelector(".preloader").classList.add("_hide"),document.querySelector(".wrapper").classList.add("_visible")),sessionStorage.getItem("money")||sessionStorage.setItem("money",5e3),document.querySelector(".check")&&document.querySelectorAll(".check").forEach((e=>{e.textContent=sessionStorage.getItem("money")})),document.querySelector(".main")&&(sessionStorage.getItem("current-bet")||sessionStorage.setItem("current-bet",500),document.querySelectorAll(".bet-main__input").forEach((e=>{e.value==+sessionStorage.getItem("current-bet")&&(e.checked=!0)})));const t=document.querySelector(".preloader"),o=document.querySelector(".wrapper"),s=document.documentElement.clientHeight,n=document.documentElement.clientWidth;let c=document.querySelectorAll(".bet-main__input");function l(e,t){let o=+sessionStorage.getItem("money");sessionStorage.setItem("money",o-e),setTimeout((()=>{document.querySelectorAll(t).forEach((e=>e.classList.add("_delete-money"))),document.querySelectorAll(t).forEach((e=>e.textContent=sessionStorage.getItem("money")))}),500),setTimeout((()=>{document.querySelectorAll(t).forEach((e=>e.classList.remove("_delete-money")))}),1500)}function m(e){document.querySelectorAll(e).forEach((e=>e.classList.add("_no-money"))),setTimeout((()=>{document.querySelectorAll(e).forEach((e=>e.classList.remove("_no-money")))}),1e3)}function i(e,t){return Math.floor(Math.random()*(t-e)+e)}let a=document.querySelectorAll(".icon-anim img");function r(){let e=+document.querySelector(".level__point_1").innerHTML,t=+document.querySelector(".level__point_2").innerHTML;document.querySelector(".level__frame-current").style.width=e/t*100+"%"}document.querySelector(".icon-anim img")&&setInterval((()=>{!function(){let e=i(0,4),t=["jump","scale","rotate","rotate-2"],o=i(0,a.length);a.forEach((e=>{e.classList.contains("_anim-icon-jump")?e.classList.remove("_anim-icon-jump"):e.classList.contains("_anim-icon-scale")?e.classList.remove("_anim-icon-scale"):e.classList.contains("_anim-icon-rotate")?e.classList.remove("_anim-icon-rotate"):e.classList.contains("_anim-icon-rotate-2")&&e.classList.remove("_anim-icon-rotate-2")})),setTimeout((()=>{a[o].classList.add(`_anim-icon-${t[e]}`)}),100)}()}),1e4),document.querySelector(".level")&&r(),document.querySelector(".main")&&document.querySelector(".preloader").classList.contains("_hide")&&document.querySelector(".main").classList.add("_active");const d=2900,g=3900;document.querySelector(".shop")&&(document.querySelector(".shop__cost_bomb").textContent=d,document.querySelector(".shop__cost_magnite").textContent=g,sessionStorage.getItem("bomb")||sessionStorage.setItem("bomb",0),sessionStorage.getItem("magnite")||sessionStorage.setItem("magnite",0));const u={row:0,col:0,count:0,pin:0};function _(){sessionStorage.setItem("bet-1",0),sessionStorage.setItem("coeff-bet-1",0),sessionStorage.setItem("bet-2",0),sessionStorage.setItem("coeff-bet-2",0),sessionStorage.setItem("bet-3",0),sessionStorage.setItem("coeff-bet-3",0),sessionStorage.setItem("bet-4",0),sessionStorage.setItem("coeff-bet-4",0),sessionStorage.setItem("bet-5",0),sessionStorage.setItem("coeff-bet-5",0),sessionStorage.setItem("candy-1",0),sessionStorage.setItem("candy-2",0),sessionStorage.setItem("candy-3",0),sessionStorage.setItem("candy-4",0),sessionStorage.setItem("candy-5",0),document.querySelectorAll(".candy-score__block").forEach((e=>{e.classList.contains("_hide")||e.classList.add("_hide")})),document.querySelectorAll(".candy-score__count").forEach((e=>{e.classList.contains("_hide")||e.classList.add("_hide")})),y(),I()}function y(e){+sessionStorage.getItem("candy-1")>0&&(S(1),+sessionStorage.getItem("candy-1")>9&&document.querySelector(".candy-score__count_1").classList.remove("_hide")),+sessionStorage.getItem("candy-2")>0&&(S(2),+sessionStorage.getItem("candy-2")>9&&document.querySelector(".candy-score__count_2").classList.remove("_hide")),+sessionStorage.getItem("candy-3")>0&&(S(3),+sessionStorage.getItem("candy-3")>9&&document.querySelector(".candy-score__count_3").classList.remove("_hide")),+sessionStorage.getItem("candy-4")>0&&(S(4),+sessionStorage.getItem("candy-4")>9&&document.querySelector(".candy-score__count_4").classList.remove("_hide")),+sessionStorage.getItem("candy-5")>0&&(S(5),+sessionStorage.getItem("candy-5")>9&&document.querySelector(".candy-score__count_5").classList.remove("_hide"))}function S(e){if(+sessionStorage.getItem(`candy-${e}`)>0){let t=sessionStorage.getItem(`candy-${e}`),o=0,s=0;+t>9?(o=t.split(""),sessionStorage.setItem(`coeff-bet-${e}`,o[0]),s=o[1]):(sessionStorage.setItem(`coeff-bet-${e}`,0),s=+t),document.querySelector(`.candy-score__count_${e}`).textContent=sessionStorage.getItem(`coeff-bet-${e}`);let n=0;document.querySelectorAll(`.candy-score__block_${e}`).forEach((e=>{console.log(e),e.classList.contains("_hide")&&n++})),n<10||document.querySelectorAll(`.candy-score__block_${e}`).forEach((e=>e.classList.add("_hide"))),document.querySelectorAll(`.candy-score__block_${e}`).forEach(((e,t)=>{t<=s-1&&e.classList.remove("_hide")})),1==e?sessionStorage.setItem("bet-1",.5*sessionStorage.getItem("coeff-bet-1")):2==e?sessionStorage.setItem("bet-2",1*sessionStorage.getItem("coeff-bet-2")):3==e?sessionStorage.setItem("bet-3",2*sessionStorage.getItem("coeff-bet-3")):4==e?sessionStorage.setItem("bet-4",5*sessionStorage.getItem("coeff-bet-4")):5==e&&sessionStorage.setItem("bet-5",10*sessionStorage.getItem("coeff-bet-5"))}}function I(){let e=[+sessionStorage.getItem("candy-1"),+sessionStorage.getItem("candy-2"),+sessionStorage.getItem("candy-3"),+sessionStorage.getItem("candy-4"),+sessionStorage.getItem("candy-5")].reduce(((e,t)=>e+t));document.querySelector(".level__point_1").textContent=e,r()}const b={countRows:5,countCols:5,offsetBorder:10,gemSize:85,imagesCoin:[1,2,3,4,5],gemClass:"gem",gemIdPrefix:"gem",gameStates:["pick","switch","revert","remove","refill"],gameState:"",movingItems:0,countScore:0},f={selectedRow:-1,selectedCol:-1,posX:"",posY:""},w={container:document.createElement("div"),content:document.createElement("div"),wrapper:document.createElement("div"),gems:new Array};function p(){if(console.log("FIND COLLISIONS"),console.log(w.gems),u.count++,w.gems[u.row][u.col]==w.gems[u.row][u.col+1]){let e=w.gems[u.row][u.col]+1;if(w.gems[u.row][u.col+1]==w.gems[u.row][u.col+2]){let t=0;document.getElementById(`gem_${u.row}_${u.col}`).dataset.collision?t=document.getElementById(`gem_${u.row}_${u.col}`).dataset.collision:document.getElementById(`gem_${u.row}_${u.col+1}`).dataset.collision?t=document.getElementById(`gem_${u.row}_${u.col+1}`).dataset.collision:document.getElementById(`gem_${u.row}_${u.col+2}`).dataset.collision&&(t=document.getElementById(`gem_${u.row}_${u.col+2}`).dataset.collision),0==t?(document.getElementById(`gem_${u.row}_${u.col}`).setAttribute("data-collision",`${e}_${u.pin}`),document.getElementById(`gem_${u.row}_${u.col+1}`).setAttribute("data-collision",`${e}_${u.pin}`),document.getElementById(`gem_${u.row}_${u.col+2}`).setAttribute("data-collision",`${e}_${u.pin}`),u.pin++):(document.getElementById(`gem_${u.row}_${u.col}`).setAttribute("data-collision",t),document.getElementById(`gem_${u.row}_${u.col+1}`).setAttribute("data-collision",t),document.getElementById(`gem_${u.row}_${u.col+2}`).setAttribute("data-collision",t))}if(u.row<4&&w.gems[u.row][u.col]==w.gems[u.row+1][u.col]){let t=0;document.getElementById(`gem_${u.row}_${u.col}`).dataset.collision?t=document.getElementById(`gem_${u.row}_${u.col}`).dataset.collision:document.getElementById(`gem_${u.row}_${u.col+1}`).dataset.collision?t=document.getElementById(`gem_${u.row}_${u.col+1}`).dataset.collision:document.getElementById(`gem_${u.row+1}_${u.col}`).dataset.collision&&(t=document.getElementById(`gem_${u.row+1}_${u.col}`).dataset.collision),0==t?(document.getElementById(`gem_${u.row}_${u.col}`).setAttribute("data-collision",`${e}_${u.pin}`),document.getElementById(`gem_${u.row}_${u.col+1}`).setAttribute("data-collision",`${e}_${u.pin}`),document.getElementById(`gem_${u.row+1}_${u.col}`).setAttribute("data-collision",`${e}_${u.pin}`),u.pin++):(document.getElementById(`gem_${u.row}_${u.col}`).setAttribute("data-collision",t),document.getElementById(`gem_${u.row}_${u.col+1}`).setAttribute("data-collision",t),document.getElementById(`gem_${u.row+1}_${u.col}`).setAttribute("data-collision",t))}if(u.row<4&&w.gems[u.row][u.col]==w.gems[u.row+1][u.col+1]){let t=0;document.getElementById(`gem_${u.row}_${u.col}`).dataset.collision?t=document.getElementById(`gem_${u.row}_${u.col}`).dataset.collision:document.getElementById(`gem_${u.row}_${u.col+1}`).dataset.collision?t=document.getElementById(`gem_${u.row}_${u.col+1}`).dataset.collision:document.getElementById(`gem_${u.row+1}_${u.col+1}`).dataset.collision&&(t=document.getElementById(`gem_${u.row+1}_${u.col+1}`).dataset.collision),0==t?(document.getElementById(`gem_${u.row}_${u.col}`).setAttribute("data-collision",`${e}_${u.pin}`),document.getElementById(`gem_${u.row}_${u.col+1}`).setAttribute("data-collision",`${e}_${u.pin}`),document.getElementById(`gem_${u.row+1}_${u.col+1}`).setAttribute("data-collision",`${e}_${u.pin}`),u.pin++):(document.getElementById(`gem_${u.row}_${u.col}`).setAttribute("data-collision",t),document.getElementById(`gem_${u.row}_${u.col+1}`).setAttribute("data-collision",t),document.getElementById(`gem_${u.row+1}_${u.col+1}`).setAttribute("data-collision",t))}}if(u.row<4&&w.gems[u.row][u.col]==w.gems[u.row+1][u.col]){let e=w.gems[u.row][u.col]+1;if(w.gems[u.row+1][u.col]==w.gems[u.row+1][u.col+1]){let t=0;document.getElementById(`gem_${u.row}_${u.col}`).dataset.collision?t=document.getElementById(`gem_${u.row}_${u.col}`).dataset.collision:document.getElementById(`gem_${u.row+1}_${u.col}`).dataset.collision?t=document.getElementById(`gem_${u.row+1}_${u.col}`).dataset.collision:document.getElementById(`gem_${u.row+1}_${u.col+1}`).dataset.collision&&(t=document.getElementById(`gem_${u.row+1}_${u.col+1}`).dataset.collision),0==t?(document.getElementById(`gem_${u.row}_${u.col}`).setAttribute("data-collision",`${e}_${u.pin}`),document.getElementById(`gem_${u.row+1}_${u.col}`).setAttribute("data-collision",`${e}_${u.pin}`),document.getElementById(`gem_${u.row+1}_${u.col+1}`).setAttribute("data-collision",`${e}_${u.pin}`),u.pin++):(document.getElementById(`gem_${u.row}_${u.col}`).setAttribute("data-collision",t),document.getElementById(`gem_${u.row+1}_${u.col}`).setAttribute("data-collision",t),document.getElementById(`gem_${u.row+1}_${u.col+1}`).setAttribute("data-collision",t))}if(u.col>0&&w.gems[u.row][u.col]==w.gems[u.row+1][u.col-1]){let t=0;document.getElementById(`gem_${u.row}_${u.col}`).dataset.collision?t=document.getElementById(`gem_${u.row}_${u.col}`).dataset.collision:document.getElementById(`gem_${u.row+1}_${u.col}`).dataset.collision?t=document.getElementById(`gem_${u.row+1}_${u.col}`).dataset.collision:document.getElementById(`gem_${u.row+1}_${u.col-1}`).dataset.collision&&(t=document.getElementById(`gem_${u.row+1}_${u.col-1}`).dataset.collision),0==t?(document.getElementById(`gem_${u.row}_${u.col}`).setAttribute("data-collision",`${e}_${u.pin}`),document.getElementById(`gem_${u.row+1}_${u.col}`).setAttribute("data-collision",`${e}_${u.pin}`),document.getElementById(`gem_${u.row+1}_${u.col-1}`).setAttribute("data-collision",`${e}_${u.pin}`),u.pin++):(document.getElementById(`gem_${u.row}_${u.col}`).setAttribute("data-collision",t),document.getElementById(`gem_${u.row+1}_${u.col}`).setAttribute("data-collision",t),document.getElementById(`gem_${u.row+1}_${u.col-1}`).setAttribute("data-collision",t))}if(u.row<3&&w.gems[u.row][u.col]==w.gems[u.row+2][u.col]){let t=0;document.getElementById(`gem_${u.row}_${u.col}`).dataset.collision?t=document.getElementById(`gem_${u.row}_${u.col}`).dataset.collision:document.getElementById(`gem_${u.row+1}_${u.col}`).dataset.collision?t=document.getElementById(`gem_${u.row+1}_${u.col}`).dataset.collision:document.getElementById(`gem_${u.row+2}_${u.col}`).dataset.collision&&(t=document.getElementById(`gem_${u.row+2}_${u.col}`).dataset.collision),0==t?(document.getElementById(`gem_${u.row}_${u.col}`).setAttribute("data-collision",`${e}_${u.pin}`),document.getElementById(`gem_${u.row+1}_${u.col}`).setAttribute("data-collision",`${e}_${u.pin}`),document.getElementById(`gem_${u.row+2}_${u.col}`).setAttribute("data-collision",`${e}_${u.pin}`),u.pin++):(document.getElementById(`gem_${u.row}_${u.col}`).setAttribute("data-collision",t),document.getElementById(`gem_${u.row+1}_${u.col}`).setAttribute("data-collision",t),document.getElementById(`gem_${u.row+2}_${u.col}`).setAttribute("data-collision",t))}}return u.col<4?u.col++:(u.col=0,u.row++),u.row>4&&0==u.col?(u.row=0,!1):p()}function E(e,t){let o=+t;console.log(t),console.log(o),1==o?sessionStorage.setItem("candy-1",+sessionStorage.getItem("candy-1")+e):2==o?sessionStorage.setItem("candy-2",+sessionStorage.getItem("candy-2")+e):3==o?sessionStorage.setItem("candy-3",+sessionStorage.getItem("candy-3")+e):4==o?sessionStorage.setItem("candy-4",+sessionStorage.getItem("candy-4")+e):5==o&&sessionStorage.setItem("candy-5",+sessionStorage.getItem("candy-5")+e)}function h(){if(0==function(){let e=Array.from(document.querySelectorAll(".gem")),t=0;return e.forEach((e=>{if(e.dataset.collision)return t=1,t})),t}()){let e=function(){let e=+sessionStorage.getItem("current-bet"),t=[+sessionStorage.getItem("bet-1"),+sessionStorage.getItem("bet-2"),+sessionStorage.getItem("bet-3"),+sessionStorage.getItem("bet-4"),+sessionStorage.getItem("bet-5")];return e*t[0]+e*t[1]+e*t[2]+e*t[3]+e*t[4]}();e>0?(!function(e,t,o,s){let n=Math.floor(+sessionStorage.getItem("money")+e);setTimeout((()=>{sessionStorage.setItem("money",n),document.querySelectorAll(t).forEach((e=>e.textContent=sessionStorage.getItem("money"))),document.querySelectorAll(t).forEach((e=>e.classList.add("_anim-add-money")))}),o),setTimeout((()=>{document.querySelectorAll(t).forEach((e=>e.classList.remove("_anim-add-money")))}),s)}(e,".check",500,1500),document.querySelector(".win__sub-text").textContent="You win!",document.querySelector(".win__text").textContent=e):(document.querySelector(".win__sub-text").textContent="You loose!",document.querySelector(".win").classList.add("_loose")),setTimeout((()=>{document.querySelector(".win").classList.add("_active")}),1e3)}}function L(e,t,o,s,n){let c=document.createElement("div");c.classList.add(b.gemClass),c.classList.add(`${b.gemClass}_${n}`),c.id=`${b.gemIdPrefix}_${o}_${s}`,c.style.top=`${e}px`,c.style.left=`${t}px`,c.style.backgroundImage=`url('img/game/icon-${n}.svg')`,c.setAttribute("data-number",n),w.wrapper.append(c)}function q(e,t){document.getElementById(`gem_${e}_${t}`).classList.add("remove"),w.gems[e][t]=-1,E(1,document.getElementById(`gem_${e}_${t}`).dataset.number),b.gameState=b.gameStates[3],B()}function A(){if(b.movingItems--,0==b.movingItems)switch(b.gameState){case b.gameStates[3]:v();break;case b.gameStates[4]:!function(){let e=0;for(let t=0;t<b.countCols;t++)-1==w.gems[0][t]&&(w.gems[0][t]=Math.floor(5*Math.random()+0),L(0,t*b.gemSize,0,t,b.imagesCoin[w.gems[0][t]]),e++);e?(b.gameState=b.gameStates[3],v()):(b.gameState=b.gameStates[0],f.selectedRow=-1,y(),I(),setTimeout((()=>{document.querySelectorAll(".gem").forEach((e=>{e.dataset.collision&&e.removeAttribute("data-collision")})),p(),h()}),500))}()}}function B(){$(".remove").each((function(){b.movingItems++,$(this).animate({opacity:0},{duration:200,complete:function(){$(this).remove(),A()}})}))}function v(){let e=0;for(let t=0;t<b.countCols;t++)for(let o=b.countRows-1;o>0;o--)-1==w.gems[o][t]&&w.gems[o-1][t]>=0&&(document.querySelector("#"+b.gemIdPrefix+"_"+(o-1)+"_"+t).classList.add("fall"),document.querySelector("#"+b.gemIdPrefix+"_"+(o-1)+"_"+t).setAttribute("id",b.gemIdPrefix+"_"+o+"_"+t),w.gems[o][t]=w.gems[o-1][t],w.gems[o-1][t]=-1,e++);$(".fall").each((function(){b.movingItems++,$(this).animate({top:"+="+b.gemSize},{duration:100,complete:function(){$(this).removeClass("fall"),A()}})})),0==e&&(b.gameState=b.gameStates[4],b.movingItems=1,A())}document.querySelector(".game")&&document.querySelector(".preloader").classList.contains("_hide")&&(!function(){s<=320?b.gemSize=45:s>320&&s<600?b.gemSize=66:s>600&&(b.gemSize=85);n<=600?b.gemSize=45:n>600&&n<720?b.gemSize=55:n>720&&n<900?b.gemSize=66:n>900&&(b.gemSize=85)}(),w.content.style.padding=b.offsetBorder+"px",w.content.style.width=b.gemSize*b.countCols+2*b.offsetBorder+"px",w.content.style.height=b.gemSize*b.countRows+2*b.offsetBorder+"px",w.content.classList.add("field__inner"),document.querySelector(".field__body").append(w.content),w.wrapper.classList.add("field__wrapper"),w.content.append(w.wrapper),function(){for(let e=0;e<b.countRows;e++){w.gems[e]=new Array;for(let t=0;t<b.countCols;t++)w.gems[e][t]=-1}for(let e=0;e<b.countRows;e++)for(let t=0;t<b.countCols;t++)w.gems[e][t]=Math.floor(5*Math.random()+0),L(e*b.gemSize,t*b.gemSize,e,t,b.imagesCoin[w.gems[e][t]])}(),b.gameState=b.gameStates[0],b.countScore=0,document.querySelector(".bonuses__count_1").textContent=sessionStorage.getItem("bomb"),document.querySelector(".bonuses__count_2").textContent=sessionStorage.getItem("magnite"),sessionStorage.setItem("candy-1",0),sessionStorage.setItem("candy-2",0),sessionStorage.setItem("candy-3",0),sessionStorage.setItem("candy-4",0),sessionStorage.setItem("candy-5",0),p(),h()),document.addEventListener("click",(e=>{let s=e.target,n=+sessionStorage.getItem("money");if(s.closest(".preloader__button")&&(sessionStorage.setItem("preloader",!0),t.classList.add("_hide"),o.classList.add("_visible"),document.querySelector(".main")&&document.querySelector(".preloader").classList.contains("_hide")&&document.querySelector(".main").classList.add("_active")),s.closest(".footer-main__button_bet")&&document.querySelector(".main__content").classList.add("_bet"),s.closest(".footer-main__button_shop")&&(document.querySelector(".main__content").classList.add("_shop"),document.querySelector(".main__hero-image").classList.add("_hide"),document.querySelector(".header__body").classList.add("_shop")),s.closest(".header__button-back")&&(document.querySelector(".main__content").classList.remove("_shop"),document.querySelector(".main__hero-image").classList.remove("_hide"),document.querySelector(".header__body").classList.remove("_shop")),s.closest(".bet-main__close-icon")){document.querySelector(".main__content").classList.remove("_bet");let e=[];c.forEach((t=>{t.checked&&e.push(t.value)})),0==e.length&&(sessionStorage.setItem("current-bet",100),document.querySelectorAll(".bet-main__input")[0].checked=!0)}if(s.closest(".bet-main__bets")&&(c.forEach((e=>{e.checked&&+e.value!=+s.closest(".bet-main__item").dataset.val&&(e.checked=!1)})),sessionStorage.setItem("current-bet",s.closest(".bet-main__item").dataset.val)),s.closest(".shop__button_1")&&(n>=d?(l(d,".check"),sessionStorage.setItem("bomb",+sessionStorage.getItem("bomb")+1),document.querySelector(".shop__image_1").classList.add("_anim"),setTimeout((()=>{document.querySelector(".shop__image_1").classList.remove("_anim")}),1e3)):m(".check")),s.closest(".shop__button_2")&&(n>=g?(l(g,".check"),sessionStorage.setItem("magnite",+sessionStorage.getItem("magnite")+1),document.querySelector(".shop__image_2").classList.add("_anim"),setTimeout((()=>{document.querySelector(".shop__image_2").classList.remove("_anim")}),1e3)):m(".check")),!s.closest(".gem")||document.querySelector(".bonuses__item_1").classList.contains("_anim")||document.querySelector(".bonuses__item_2").classList.contains("_anim")||(!function(e){let t=0;if(!e.dataset.collision)return e.classList.add("_anim"),setTimeout((()=>{e.classList.remove("_anim")}),1e3),!1;t=e.dataset.collision,document.querySelectorAll(".gem").forEach((e=>{if(e.dataset.collision&&e.dataset.collision==t){let t=parseInt(e.getAttribute("id").split("_")[1]),o=parseInt(e.getAttribute("id").split("_")[2]);w.gems[t][o]=-1,e.classList.add("remove")}}));let o=0;document.querySelectorAll(".gem").forEach((e=>{e.classList.contains("remove")&&o++}));let s=parseInt(t.split("_")[0]);E(o,s),b.gameState=b.gameStates[3],B()}(s.closest(".gem")),document.querySelector(".field__wrapper").classList.add("_hold"),setTimeout((()=>{document.querySelector(".field__wrapper").classList.remove("_hold")}),550)),s.closest(".win__button_play")&&(u.pin=0,_(),document.querySelectorAll(".gem").forEach((e=>{let t=parseInt(e.getAttribute("id").split("_")[1]),o=parseInt(e.getAttribute("id").split("_")[2]);w.gems[t][o]=-1,e.classList.add("remove")})),b.gameState=b.gameStates[3],B(),setTimeout((()=>{document.querySelector(".win").classList.remove("_active"),document.querySelector(".win").classList.contains("_loose")&&document.querySelector(".win").classList.remove("_loose")}),500)),s.closest(".win__button_home")&&_(),s.closest(".bonuses__item_1")&&0!=+sessionStorage.getItem("bomb")&&(sessionStorage.setItem("bomb",+sessionStorage.getItem("bomb")-1),s.closest(".bonuses__item_1").classList.add("_anim")),s.closest(".bonuses__item_2")&&0!=+sessionStorage.getItem("magnite")&&(sessionStorage.setItem("magnite",+sessionStorage.getItem("magnite")-1),s.closest(".bonuses__item_2").classList.add("_anim")),s.closest(".gem")&&document.querySelector(".bonuses__item_1").classList.contains("_anim")){!function(e){b.movingItems++,document.querySelector(".bonuses__item_1").classList.remove("_anim");let t,o,s,n,c,l,m,i,a=parseInt(e.getAttribute("id").split("_")[1]),r=parseInt(e.getAttribute("id").split("_")[2]);a>0&&a<4&&r>0&&r<4&&(t=a-1,o=r,s=a,n=r-1,c=a,l=r+1,m=a+1,i=r,console.log("Применяем бомбу не с краев")),0==a&&r>0&&r<4&&(s=a,n=r-1,c=a,l=r+1,m=a+1,i=r),0==a&&0==r&&(c=a,l=r+1,m=a+1,i=r),0==a&&4==r&&(s=a,n=r-1,m=a+1,i=r),a>0&&a<4&&0==r&&(t=a-1,o=r,c=a,l=r+1,m=a+1,i=r),a>0&&a<4&&4==r&&(t=a-1,o=r,s=a,n=r-1,m=a+1,i=r),4==a&&r>0&&r<4&&(t=a-1,o=r,s=a,n=r-1,c=a,l=r+1),4==a&&0==r&&(t=a-1,o=r,c=a,l=r+1),4==a&&4==r&&(t=a-1,o=r,s=a,n=r-1),document.getElementById(`gem_${a}_${r}`)&&(q(a,r),document.getElementById(`gem_${a}_${r}`).remove()),document.getElementById(`gem_${t}_${o}`)&&(q(t,o),document.getElementById(`gem_${t}_${o}`).remove()),document.getElementById(`gem_${s}_${n}`)&&(q(s,n),document.getElementById(`gem_${s}_${n}`).remove()),document.getElementById(`gem_${c}_${l}`)&&(q(c,l),document.getElementById(`gem_${c}_${l}`).remove()),document.getElementById(`gem_${m}_${i}`)&&(q(m,i),document.getElementById(`gem_${m}_${i}`).remove()),b.gameState=b.gameStates[3],A()}(s.closest(".gem")),document.querySelector(".bonuses__count_1").textContent=sessionStorage.getItem("bomb")}if(s.closest(".gem")&&document.querySelector(".bonuses__item_2").classList.contains("_anim")&&!document.querySelector(".field__wrapper").classList.contains("_magnite")){console.log("=======first=========");let e=s.closest(".gem");i=e,console.log(w.gems),b.movingItems++,i.classList.add("_magnite"),setTimeout((()=>{document.querySelector(".field__wrapper").classList.add("_magnite")}),500)}var i;if(s.closest(".gem")&&document.querySelector(".bonuses__item_2").classList.contains("_anim")&&document.querySelector(".field__wrapper").classList.contains("_magnite")){console.log("=======second========="),!function(e){let t="",o=0;document.querySelectorAll(".gem").forEach((e=>{e.classList.contains("_magnite")&&(t=e,o=+e.dataset.number)}));let s=parseInt(t.getAttribute("id").split("_")[1]),n=parseInt(t.getAttribute("id").split("_")[1]),c=parseInt(e.getAttribute("id").split("_")[1]),l=parseInt(e.getAttribute("id").split("_")[1]),m=+e.dataset.number;t.style.backgroundImage=`url('img/game/icon-${m}.svg')`,t.classList.remove(`gem_${o}`),t.classList.add(`gem_${m}`),t.dataset.number=m,e.style.backgroundImage=`url('img/game/icon-${o}.svg')`,e.classList.remove(`gem_${m}`),e.classList.add(`gem_${o}`),e.dataset.number=o,console.log(w.gems),console.log(w.gems[s][n]),console.log(w.gems[c][l]),o-=1,m-=1,console.log(o),console.log(m),w.gems[c][l]=o,w.gems[s][n]=m,console.log(w.gems),document.querySelectorAll(".gem").forEach((e=>{e.classList.contains("_magnite")&&e.classList.remove("_magnite")})),document.querySelector(".bonuses__item_2").classList.remove("_anim"),setTimeout((()=>{document.querySelector(".field__wrapper").classList.remove("_magnite")}),500),document.querySelectorAll(".gem").forEach((e=>{e.dataset.collision&&e.removeAttribute("data-collision")})),setTimeout((()=>{p()}),500)}(s.closest(".gem")),document.querySelector(".bonuses__count_2").textContent=sessionStorage.getItem("magnite")}})),window.FLS=!0,function(e){let t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}((function(e){let t=!0===e?"webp":"no-webp";document.documentElement.classList.add(t)})),window.addEventListener("load",(function(){document.querySelector("body")&&setTimeout((function(){document.querySelector("body").classList.add("_loaded")}),200)}))})();